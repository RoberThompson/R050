#ifndef GLOBALS_H
#define GLOBALS_H

//TIMING PARAMETERS
unsigned long LOOP_TIME;
unsigned long CURRENT_MILLIS = 0; //used to keep track of time
unsigned long PREVIOUS_MILLIS = 0; //used to keep track of time
unsigned long PREVIOUS_MILLIS_1 = 0; //used for checking times within temp bounds case 6,7,8,9
unsigned long PREVIOUS_MILLIS_2 = 0; //used in case 7
unsigned long PREVIOUS_MILLIS_3 = 0; //used in readTCs function
unsigned long PREVIOUS_MILLIS_4 = 0; //used in readOut function
unsigned long PREVIOUS_MILLIS_5 = 0; //used in blinkGRN() function
unsigned long PREVIOUS_MILLIS_6 = 0; //used in blinkAMB() function
unsigned long LOOP_MILLIS = 0; //used to caluclate loop function time.

//timing constants
const long BMM_PURGE_TIMER = 32000;
const long BMM_IGNITION_TIMER = 30000;
const long BMM_OFF_TIMER = 5000;
const long BMM_ON_TIMER = 5000;
const long BURNER_HOLD_100C_TIMER = 1800000; //30 MINS
const long BURNER_HOLD_250C_TIMER = 3600000; //1HR
const long BURNER_HOLD_350C_TIMER = 7200000;//2hr
const long BURNER_HOLD_450C_TIMER = 3600000;//1HR
const long BURNER_HOLD_600C_TIMER = 3600000;//1hr

//counter
uint8_t TC_CHECK_COUNTER = 1; //used in readTC function
uint8_t READOUT_COUNTER = 1; //used in readOut function

//BLOWER VARIABLES
const int BLOWER_PURGE_SPEED = 10000, BLOWER_IGNITION_SPEED = 1000, BLOWER_RAMP_END = 4000; //2 to keep the dps triggered .17 * 20043counts
const int BLOWER_TOP_SPEED = 6375;

//RO PUMP VARIABLES
const int MAX_RO_PRESSURE = 250; //psi
const int RO_PUMP_AT_10_GRAMS_PER_SEC = 1250 , RO_PUMP_TOP_SPEED = 5000; //counts//3000

//FLOW CONTROL VALVES
uint8_t FCV205_HX406_INLET_FLOW = 0; //g/sec
const int FCV205_AT_50_PERCENT = 5000; //initiated in case 9
const int FCV205_AT_35_PERCENT = 3500; //initiated in case 3??
const int FCV134_BURNER_FUEL_FLOW_IGNITION = 6000, FCV134_BURNER_FUEL_FLOW_RAMP_END = 7000; //5 volts ~40 percent open

//INITIALIZE PRESSURE TRANSDUCER VARIABLES
uint16_t PT213_RO_PRESSURE, PT318_HX406_OUTPUT_PRESSURE; //psi
uint16_t PT420_STEAM_EJECTOR_PRESSURE, PT304_TWV308_INPUT_PRESSURE; //psi

//INITIALIZE THERMOCOUPLE VARIABLES
uint16_t TT142_SR_FUEL, TT301_HX406_STEAM_OUT, TT303_HX504_STEAM_OUT, TT306_EJECTOR_STEAM_IN;
uint16_t TT313_HX402_STEAM_OUT, TT319_HX402_STEAM_SYSTEM, TT407_STEAM_REFORMER_OUT_LREF;
uint16_t TT408_HTS_IN_LREF, TT410_HTS_OUT_LREF, TT411_FPZ_OUT_LREF, TT430_SMR_TUBES_INLET;
uint16_t TT511_SILICON_CARBIDE_OUT, TT512_SILICON_CARBIDE_OUT, TT513_HX504_IN, TT514_HX504_OUT;
uint16_t TT441_SMR_TUBE1_OUT, TT442_SMR_TUBE2_OUT, TT443_SMR_TUBE3_OUT, TT444_SMR_TUBE4_OUT;
uint16_t TT445_SMR_TUBE5_OUT, TT446_SMR_TUBE6_OUT, TT447_SMR_TUBE7_OUT, TT448_SMR_TUBE8_OUT;
uint16_t TT449_SMR_TUBE9_OUT;

bool initTimer = false;
uint8_t PREVIOUS_FSM_STATE = 0;

//OCI417 MODBUS RS485 PARAMETERS
const int OCI_INPUT_STATUS_REGISTER = 25;
const int OCI_OUTPUT_STATUS_REGISTER = 26;
const int OCI_UNIT_ID = 1;
uint16_t OCI_INPUT_STATUS_WORD = 0;
uint16_t OCI_OUTPUT_STATUS_WORD = 0;
uint8_t OCI_RESULT;
bool COMBUSTION_PRESSURE_SWITCH, BMM_ALARM_STATUS;
bool BMM_PROOF_OF_FLAME, OCI_TO_BMM_COM;
bool DUN_PSH, DUN_PSL, DUN_ZSL;

//FLAGS
bool GRN_BTN_FLAG = false, AMB_BTN_FLAG = false, ESTOP_FLAG = false, SENSOR_INTEGRITY_CHECK = false;
bool GRN_PLT_STATE = false, AMB_PLT_STATE = false;
uint16_t LAST_DI_STATUS_WORD = 0, CURRENT_DI_STATUS_WORD = 0, DI_STATUS_CHANGE = 0;
bool PSI_INIT_TIMER = false;

enum {INITIALIZE, BMM_OFF, BMM_ON,
      BMM_PURGE, BMM_IGNITION, BURNER_HOLD_100C, BURNER_HOLD_250C, BURNER_HOLD_350C,
      BURNER_HOLD_450C, BURNER_HOLD_600C, FINISH
     } FSM_STATE;


uint8_t ERROR = 0; //ERROR 0 means no ERROR.

#endif
